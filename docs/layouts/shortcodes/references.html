{{ $refs := split (trim .Inner "\n") "\n" }}

<ol class="ref">
  {{ range $ref := $refs }}
    {{ $tags := findRE "^{#[^}]*}" $ref }}
    {{ $text := $ref }}
    <li
      {{ with index $tags 0 }}
        {{ $text = substr $ref (len .) }}
        id="{{ trim . "{#}" }}"
      {{ end }}
    >
      {{ $text | $.Page.RenderString | safeHTML }}
    </li>
  {{ end }}
</ol>
